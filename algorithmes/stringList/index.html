<!--
Soit un tableau de noms : names

1- Afficher un tableau contenant la liste triée alphabétiquement avec un nom par ligne

2- En cas de noms multiples afficher uniquement une ligne avec :
Le fond orange si elle apparait 2 fois
Le fond rouge si elle apparait 3 fois ou plus

-->
<html ng-app="app">

<head>
    <title>Algo Angular</title>
    <link rel="stylesheet" href="/libs/tacit-0.6.1.min.css">
</head>
<style>
    .orange {
        background-color: orange;
    }

    .red {
        background-color: red;
    }
</style>

<body>
    <h1>Exams 2 Algo Angular</h1>
    <list></list>

</body>
<script src="libs/angular.min.js"></script>
<script>
    const names = ['Jean', 'Pierre', 'Louis', 'Jean', 'William', 'Jean', 'Mila',
        'Mila', 'Nori', 'Brianna', 'Yu', 'Tomoko', 'Tomoko', 'Tomoko', 'Tomoko',
        'Della', 'Terica', 'Debby', 'Rosy', 'Suzi', 'Ron', 'Ron', 'Viviana', 'Wes',
        'Matt', 'Karla', 'Alia', 'Ramon', 'Ramon', 'Sandra', 'Luigi', 'Luigi', 'Luigi',
        'Luigi', 'Luigi', 'Luigi', 'Luigi', 'Vesta', 'Ladawn', 'Geralyn'
    ];

    var app = angular.module('app', [])
    app.component('list', {
        template: `<table>
                <tr><th>Noms</th></tr>
                <tr ng-repeat="(key, value) in $ctrl.names track by $index" ng-class="value == 2 ? 'orange' : value >= 3 ? 'red' : ''">
                    <td>
                        {{key}}
                    </td>
                    <td>
                        {{value}}
                    </td>
                </tr>
            </table>`,
        controller: function() {
            // order array names
            this.names = names.sort()

            // create table with every values : name and count
            let count = 1
            let table = []
            for (let i in names) {
                if (names[i - 1] === names[i]) {
                    count++
                } else {
                    count = 1
                }
                table.push(table.name = names[i])
                table.push(table.count = count)

            }

            // create object with name = key, count = value
            let myobj = {};
            table.forEach(function(item, index) {
                if (index % 2 === 0) {
                    myobj[item] = table[index + 1]
                }
            })

            // affect myobj to this.names
            this.names = myobj

        }
    })
</script>

</html>
